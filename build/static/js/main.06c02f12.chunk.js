(this["webpackJsonpreact-snake"]=this["webpackJsonpreact-snake"]||[]).push([[0],{13:function(t,e,i){},14:function(t,e,i){},15:function(t,e,i){"use strict";i.r(e);var n=i(0),s=i.n(n),o=i(6),a=i.n(o),r=(i(13),i(1)),u=i(2),h=i(4),c=i(3);var l=function(){return s.a.createElement("header",null,s.a.createElement("h1",null,s.a.createElement("span",{role:"img","aria-label":"snake emoji"},"\ud83d\udc0d")," Snake!"))},d=function(){function t(){Object(r.a)(this,t),this.sounds={blip:{url:"/static/audio/blip.mp3",volume:.05},fail:{url:"/static/audio/fail.mp3",volume:.05}}}return Object(u.a)(t,[{key:"getContext",value:function(){if(!this.audioContext){var t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,this.audioContext.resume()}return this.audioContext}},{key:"loadAll",value:function(){for(var t in this.sounds)this.loadItem(t);return this}},{key:"loadItem",value:function(t){var e=this,i=new XMLHttpRequest;i.open("GET",this.sounds[t].url,!0),i.responseType="arraybuffer",i.onload=function(){e.getContext().decodeAudioData(i.response,(function(i){e.sounds[t].buffer=i}))},i.send()}},{key:"play",value:function(t){var e=this.sounds[t],i=this.sounds[t].volume||.5;if(e.buffer){var n=this.getContext().createBufferSource();n.buffer=e.buffer;var s=this.getContext().createGain();s.gain.value=i,s.connect(this.getContext().destination),n.connect(s),n.start()}return this}}]),t}(),y=i(7),f=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(r.a)(this,t),this.dims=e,this.setPixels(i)}return Object(u.a)(t,[{key:"setPixels",value:function(t){this.pixels=[];var e,i=Object(y.a)(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.pixels=this.pixels.concat(n.getPixels())}}catch(s){i.e(s)}finally{i.f()}return this.pixels}},{key:"indexToCoord",value:function(t){var e=Math.floor(t/this.dims.x);return[t-this.dims.x*e,e]}},{key:"coordToIndex",value:function(t){return t[0]+this.dims.x*t[1]}},{key:"getAllCoords",value:function(){for(var t=[],e=0;e<this.dims.y;e++)for(var i=0;i<this.dims.x;i++)t.push([i,e]);return t}}]),t}(),v=function(){function t(e){Object(r.a)(this,t),this.maxLength=e,this.items=[]}return Object(u.a)(t,[{key:"size",value:function(){return this.items.length}},{key:"isEmpty",value:function(){return 0===this.size()}},{key:"isNotEmpty",value:function(){return!this.isEmpty()}},{key:"enqueue",value:function(t){return this.size()!==this.maxLength&&this.items.push(t)>0}},{key:"dequeue",value:function(){return this.items.shift()}}]),t}(),p=function(){function t(e){Object(r.a)(this,t),this.dims=e}return Object(u.a)(t,[{key:"pixel",value:function(t,e,i){return{coord:[t,e],color:i}}}]),t}(),m=function(t){Object(h.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(r.a)(this,i),(n=e.call(this,t)).dirs={U:{code:"U",vector:{x:0,y:-1}},D:{code:"D",vector:{x:0,y:1}},L:{code:"L",vector:{x:-1,y:0}},R:{code:"R",vector:{x:1,y:0}}},n.dirKeys={87:"U",38:"U",83:"D",40:"D",65:"L",37:"L",68:"R",39:"R"},n.invDirs={U:"D",D:"U",L:"R",R:"L"},n.color="rgb(30, 200, 11)",n.headColor="rgb(25, 245, 25)",n.body=[n.newSegment()],n}return Object(u.a)(i,[{key:"head",value:function(){return this.body[0]}},{key:"tail",value:function(){return this.body[this.body.length-1]}},{key:"directByKey",value:function(t){this.dirKeys.hasOwnProperty(t)&&this.head().dir.code!==this.invDirs[this.dirKeys[t]]&&(this.head().dir=this.dirs[this.dirKeys[t]])}},{key:"headMeets",value:function(t){return this.head().pos.x===t.x&&this.head().pos.y===t.y}},{key:"headMeetsBody",value:function(){for(var t=1;t<this.body.length;t++)if(this.headMeets(this.body[t].pos))return!0;return!1}},{key:"nextCoord",value:function(t,e,i){return(t+=e)===i?t=0:t<0&&(t=i-1),t}},{key:"updatePosition",value:function(){for(var t=0;t<this.body.length;t++)for(var e=0,i=["x","y"];e<i.length;e++){var n=i[e];this.body[t].pos[n]=this.nextCoord(this.body[t].pos[n],this.body[t].dir.vector[n],this.dims[n])}return this}},{key:"updateDirections",value:function(){for(var t=this.body.length-1;t>0;t--)this.body[t].dir=this.body[t-1].dir;return this}},{key:"move",value:function(){this.updatePosition().updateDirections()}},{key:"newSegment",value:function(){return{pos:{x:-1,y:0},dir:this.dirs.R}}},{key:"grow",value:function(){var t=this.newSegment();t.dir=this.tail().dir,t.pos.x=this.nextCoord(this.tail().pos.x,-1*t.dir.vector.x,this.dims.x),t.pos.y=this.nextCoord(this.tail().pos.y,-1*t.dir.vector.y,this.dims.y),this.body.push(t)}},{key:"getPixels",value:function(){for(var t=[],e=0;e<this.body.length;e++){var i=0===e?this.headColor:this.color;t.push(this.pixel(this.body[e].pos.x,this.body[e].pos.y,i))}return t}}]),i}(p),k=function(t){Object(h.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(r.a)(this,i),(n=e.call(this,t)).position=null,n.padding=1,n.scoreValue=10,n.color="rgb(237, 14, 86)",n}return Object(u.a)(i,[{key:"isPlaced",value:function(){return null!==this.position}},{key:"place",value:function(){null===this.position&&(this.position={});var t=Math.floor(this.dims.x)-1,e=Math.floor(this.dims.y)-1;this.position.x=this.randBetween(this.padding,t-this.padding),this.position.y=this.randBetween(this.padding,e-this.padding)}},{key:"take",value:function(){this.position=null}},{key:"randBetween",value:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},{key:"getPixels",value:function(){return this.isPlaced()?this.pixel(this.position.x,this.position.y,this.color):[]}}]),i}(p),b=function(t){Object(h.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(r.a)(this,i),(n=e.call(this,t)).inPlay=!1,n.framesPerSecond=10,n.dims=n.calcDimensions(t.width,t.height,t.scale),n.canvas=s.a.createRef(),n.keyQueue=new v(2),n.keyQueue.enqueue(39),n.audio=new d,n}return Object(u.a)(i,[{key:"calcDimensions",value:function(t,e,i){var n=t/i,s=e/i;if(n%1!==0||s%1!==0)throw new Error("Bad scale");return{x:n,y:s}}},{key:"bindKeydowns",value:function(){var t=this;return window.addEventListener("keydown",(function(e){t.keyQueue.enqueue(e.keyCode),t.hadFirstInteraction||t.handleFirstInteraction()}))}},{key:"handleFirstInteraction",value:function(){this.audio.loadAll(),this.hadFirstInteraction=!0}},{key:"setInPlay",value:function(t){this.inPlay=t,this.props.setInPlay(t)}},{key:"componentDidMount",value:function(){this.bindKeydowns(),this.start()}},{key:"start",value:function(){this.setInPlay(!0),this.snake=new m(this.dims),this.fruit=new k(this.dims),this.fruit.place(),this.animate()}},{key:"play",value:function(){this.keyQueue.isNotEmpty()&&this.snake.directByKey(this.keyQueue.dequeue()),this.snake.move(),this.snake.headMeets(this.fruit.position)&&(this.snake.grow(),this.fruit.place(),this.audio.play("blip"),this.props.addToScore(this.fruit.scoreValue)),this.snake.headMeetsBody()&&(this.stop(),this.audio.play("fail"));var t=[this.fruit,this.snake];return new f(this.dims,t)}},{key:"stop",value:function(){this.setInPlay(!1),clearTimeout(this.timerId)}},{key:"draw",value:function(t,e,i){e.clearRect(0,0,t.width,t.height);for(var n=i.pixels.length-1;n>-1;n--)e.fillStyle=i.pixels[n].color,e.fillRect(i.pixels[n].coord[0]*this.props.scale,i.pixels[n].coord[1]*this.props.scale,this.props.scale,this.props.scale)}},{key:"animate",value:function(){var t=this;this.inPlay&&(this.timerId=setTimeout((function(){t.animateId=requestAnimationFrame((function(){return t.animate()})),t.draw(t.canvas.current,t.canvas.current.getContext("2d"),t.play())}),1e3/this.framesPerSecond))}},{key:"render",value:function(){return s.a.createElement("canvas",{ref:this.canvas,width:this.props.width,height:this.props.height})}}]),i}(n.Component),x=(i(14),function(t){Object(h.a)(i,t);var e=Object(c.a)(i);function i(){var t;Object(r.a)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).state={inPlay:!1,score:0},t}return Object(u.a)(i,[{key:"setInPlay",value:function(t){this.setState({inPlay:t})}},{key:"addToScore",value:function(t){this.setState({score:this.state.score+t})}},{key:"render",value:function(){var t=!1===this.state.inPlay&&this.state.score>0?"Game over! Refresh to play again.":"Play on! Use arrow or WASD keys.";return s.a.createElement("div",{className:"container"},s.a.createElement(l,null),s.a.createElement(b,{width:800,height:450,scale:25,setInPlay:this.setInPlay.bind(this),addToScore:this.addToScore.bind(this)}),s.a.createElement("h2",null,"Score: ",this.state.score),s.a.createElement("h3",null,t))}}]),i}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},8:function(t,e,i){t.exports=i(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.06c02f12.chunk.js.map